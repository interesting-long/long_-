C251 COMPILER V5.60.0,  Strategy                                                           05/10/25  12:52:32  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE Strategy
OBJECT MODULE PLACED IN .\out_file\Strategy.obj
COMPILER INVOKED BY: D:\keil\C251\BIN\C251.EXE ..\code\Strategy.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(3,SIZE)
                    - BROWSE INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driv
                    -er;..\user;..\code) DEBUG PRINT(.\out_file\Strategy.lst) OBJECT(.\out_file\Strategy.obj) 

stmt  level    source

    1          #include "Strategy.h"
    2          float uni=0;
    3          float last_uni=0;
    4          unsigned int if_time=0;
    5          unsigned int if2_time=0;
    6          unsigned int Continue_Time=0;
    7          unsigned char Enter_Flag_Left=0;
    8          unsigned char Cycle_Stat=EXIT;
    9          
   10          unsigned char Road_Stat=Normal_Str;
   11          unsigned int Short_Time=0;
   12          unsigned int Long_Time=0;
   13          unsigned int Bend_Time=0;
   14          unsigned int slow_Time=0;
   15          
   16          unsigned int Entern_Flag_Time=0;
   17          unsigned int Entern_Delay_Time=0;
   18          unsigned int Entern_Continue_Time=0;
   19          int turn_Value=0;
   20          int Mode_Flag=0;
   21          //环岛判断
   22          void if_Cycle(void)
   23          {
   24   1              switch(Cycle_Stat)
   25   1              {
   26   2                      case EXIT:
   27   2                      {
   28   3                              Buzzer_OFF();
   29   3                              if(ADC_2==1023 || ADC_3==1023 )
   30   3                              {
   31   4                                      if_time++;
   32   4                                      if(if_time>Entern_Flag_Time)
   33   4                                      {
   34   5                                              Cycle_Stat=APPROACH;
   35   5                                              if_time=0;
   36   5                                      }
   37   4                              }
   38   3                              else
   39   3                              {
   40   4                                      if_time=0;
   41   4                              }
   42   3                              break;
   43   3                      }
   44   2                      case APPROACH:
   45   2                      {
   46   3                              if(ADC_2!=1023 || ADC_3!=1023)
   47   3                              {
   48   4                                      if2_time++;
   49   4                                      if(if2_time>Entern_Delay_Time)
   50   4                                      {
   51   5                                              Cycle_Stat=Left_ENTER;
   52   5                                              if2_time=0;
   53   5                                      }
   54   4                              }
   55   3                              break;
   56   3                      }
   57   2                      case Left_ENTER:
C251 COMPILER V5.60.0,  Strategy                                                           05/10/25  12:52:32  PAGE 2   

   58   2                      {
   59   3                              Enter_Flag_Left=1;
   60   3                              Buzzer_ON();
   61   3                              Continue_Time++;
   62   3                              if(Continue_Time>Entern_Continue_Time)
   63   3                              {
   64   4                                      Cycle_Stat=EXIT;
   65   4                                      Continue_Time = 0;  //
   66   4                      Enter_Flag_Left = 0;     //
   67   4                              }
   68   3                              break;
   69   3                      }
   70   2              }
   71   1      
   72   1      }
   73          //切弯补丁
   74          int Help_turn()
   75          {
   76   1              int left  = ADC_1 + ADC_2;
   77   1              int right = ADC_3 + ADC_4;
   78   1              if (left < 200 && right < 200)
   79   1              {
   80   2                      // 同时满足，取较小一侧优先
   81   2                      if (left < right)
   82   2                              return -40;   // 左
   83   2                      else
   84   2                              return 40;    // 右
   85   2              }
   86   1              else if (left < 200)
   87   1              {
   88   2                      return -40;   // 左
   89   2              }
   90   1              else if (right < 200)
   91   1              {
   92   2                      return 40;    // 右
   93   2              }
   94   1              else
   95   1              {
   96   2                      return 0;     // 不转
   97   2              }
   98   1      }
   99          
  100          void State_of_road(void)
  101          {
  102   1              switch(Road_Stat)
  103   1              {
  104   2                      case Normal_Str:
  105   2                      {
  106   3                              if(dajiao<20 && dajiao>-20)
  107   3                              {
  108   4                                      Short_Time++;
  109   4                                      if(Short_Time>20)
  110   4                                      {
  111   5                                              Short_Time=0;
  112   5                                              Road_Stat=Short_Str;
  113   5                                              Motor_Update(2);
  114   5                                              Buzzer_ON();
  115   5                                      }
  116   4                              }
  117   3                              break;
  118   3                      }
  119   2                      case Short_Str:
  120   2                      {
  121   3                              if(dajiao<20 && dajiao>-20)
  122   3                              {
  123   4                                      Long_Time++;
C251 COMPILER V5.60.0,  Strategy                                                           05/10/25  12:52:32  PAGE 3   

  124   4                                      if(Long_Time>100)
  125   4                                      {
  126   5                                              Long_Time=0;
  127   5                                              Road_Stat=Long_Str;
  128   5                                              Buzzer_OFF();
  129   5                                              Motor_Update(5);
  130   5                                      }
  131   4                              }
  132   3                              break;
  133   3                      }
  134   2                      case Long_Str:
  135   2                      {
  136   3                              if(dajiao>50 || dajiao<-50)
  137   3                              {
  138   4                                      Bend_Time++;
  139   4                                      if(Bend_Time>5)
  140   4                                      {
  141   5                                              Bend_Time=0;
  142   5                                              Road_Stat=Bend;
  143   5                                              Motor_Update(0);
  144   5                                              Buzzer_ON();
  145   5                                      }
  146   4                              
  147   4                              }
  148   3                              break;
  149   3                      }
  150   2                      case Bend:
  151   2                      {
  152   3                              slow_Time++;
  153   3                              if(slow_Time<20)
  154   3                              {
  155   4                                      MotorR_SetSpeed(100*0);
  156   4                                      MotorL_SetSpeed(100*0);
  157   4                              }
  158   3                              else
  159   3                              {
  160   4                                      if(dajiao>50)
  161   4                                      {
  162   5                                              Motor_Update(0);
  163   5                                      }
  164   4                                      else if( dajiao<-50)
  165   4                                      {
  166   5                                              Motor_Update(0);
  167   5                                      }
  168   4                                      else
  169   4                                      {
  170   5                                              slow_Time=0;
  171   5                                              Road_Stat=Normal_Str;
  172   5                                              Motor_Update(0);
  173   5                                              Buzzer_OFF();
  174   5                                      }
  175   4                              }
  176   3                              break;
  177   3                      }
  178   2              
  179   2              }       
  180   1      
  181   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       663     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
C251 COMPILER V5.60.0,  Strategy                                                           05/10/25  12:52:32  PAGE 4   

  xdata size           =        35     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =       120     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
