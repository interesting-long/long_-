C251 COMPILER V5.60.0,  Key                                                                12/09/25  16:41:15  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE Key
OBJECT MODULE PLACED IN .\out_file\Key.obj
COMPILER INVOKED BY: D:\keil\C251\BIN\C251.EXE ..\code\Key.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(3,SIZE) BROW
                    -SE INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driver;..
                    -\user;..\code) DEBUG PRINT(.\out_file\Key.lst) OBJECT(.\out_file\Key.obj) 

stmt  level    source

    1          #include "Key.h"
    2          
    3          int Press_time;
    4          int Trigg_time;
    5          unsigned char keynumber;
    6          unsigned char State;
    7          unsigned char Key_count;
    8          unsigned Time_dou;
    9          
   10          unsigned char CAR_Mode=STOP;
   11          
   12          unsigned char Key_Number(void)
   13          {
   14   1          unsigned char KeyNumber=0;
   15   1      
   16   1          if(gpio_get_level(IO_P46)==0){KeyNumber=1;}//左
   17   1          if(gpio_get_level(IO_P45)==0){KeyNumber=2;}//右
   18   1          if(gpio_get_level(IO_P37)==0){KeyNumber=3;}//中
   19   1          if(gpio_get_level(IO_P36)==0){KeyNumber=4;}//上
   20   1          return KeyNumber;
   21   1      }
   22          
   23          void Key_scaner(void)
   24          {
   25   1              keynumber=Key_Number();
   26   1              switch(State)
   27   1              {
   28   2                      case State_Release:
   29   2                      {
   30   3                              if(keynumber!=0)
   31   3                              {
   32   4                                      State=State_Press_dou;
   33   4                                      Key_count=0;
   34   4                              }
   35   3                              break;
   36   3                      }
   37   2                      case State_Press_dou:
   38   2                      {
   39   3                              if(keynumber==0)
   40   3                              {
   41   4                                      State=State_Release;
   42   4                              }
   43   3                              else
   44   3                              {
   45   4                                      Key_count++;
   46   4                                      if(Key_count>=Time_dou)
   47   4                                      {
   48   5                                              State=State_Press;
   49   5                                              Key=keynumber;
   50   5                                      }
   51   4                              }
   52   3                              break;
   53   3                      }
   54   2                      case State_Press:
   55   2                      {
   56   3                              if(keynumber==0)
   57   3                              {
C251 COMPILER V5.60.0,  Key                                                                12/09/25  16:41:15  PAGE 2   

   58   4                                      State=State_Release_dou;
   59   4                                      Key_count=0;
   60   4                                      Press_time=0;
   61   4                              }
   62   3                              else
   63   3                              {
   64   4                                      Press_time++;
   65   4                                      if(Press_time>Flag_press_time)
   66   4                                      {
   67   5                                              Trigg_time++;
   68   5                                              if(keynumber==3)//长按触发的操作
   69   5                                              {
   70   6                                                      if(CAR_Mode==STOP)
   71   6                                                      {
   72   7                                                              CAR_Mode=GO;
   73   7                                                      }
   74   6                                                      else
   75   6                                                      {
   76   7                                                              CAR_Mode=STOP;
   77   7                                                      }
   78   6                                                      Press_time=0;
   79   6                                              }
   80   5                                              else if(Trigg_time>Flag_trigg_time)
   81   5                                              {
   82   6                                                      Trigg_time=0;
   83   6                                                      Key=keynumber;
   84   6                                                      //多次触发的操作
   85   6                                              }
   86   5                                      }
   87   4                              }
   88   3                              break;
   89   3                      }
   90   2                      case State_Release_dou:
   91   2                      {
   92   3                              if(keynumber==0)
   93   3                              {
   94   4                                      Key_count++;
   95   4                                      if(Key_count>=Time_dou)
   96   4                                      {
   97   5                                              State=State_Release;
   98   5                                              Key=0;  // 松开时清零
   99   5                                      }
  100   4                              }
  101   3                              else
  102   3                              {
  103   4                                      State=State_Press;
  104   4                              }
  105   3                              break;
  106   3                      }
  107   2              }
  108   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       346     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =        10     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
C251 COMPILER V5.60.0,  Key                                                                12/09/25  16:41:15  PAGE 3   

  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =         6     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
